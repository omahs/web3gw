# SFTPGO integration

[Sftpgo](https://github.com/drakkan/sftpgo) is a SFTP web server with HTTP and webdav support. This server is integrated in web3 proxy, providing a simple to use web client that allows users to manage and share their files.

The integration is done through our own fork of the project found [here](https://github.com/alichaddad/sftpgo). This integration build on what is already available and add additional features like allowing editing of office documents through the web client and improving syntax highlighting for selected languages.

## Enabling the server

To start the server you need to pass the following command argument to the web proxy binary:

```bash
-sftp-config-dir {sftpgodir}
```

Where `sftpgodir` is the directory that will contain the secrets generated by the server during the initial start. Most importantly the directory should include `sftpgo.json` which configures the server.

There is a config file at the root of the repo that can be used, although it mind be necessary to change the following sections:

- `httpd.templates_path`: this should point to the templates used by SFTPGO to generate the UI. This usually can be found at the root of the sftpgo fork
- `httpd.static_files_path`: this points to additional static files needed for the UI, should also be in the root of the fork

In addition to the above configuration the following env variables need to be specified:

- `SFTPGO_DEFAULT_ADMIN_USERNAME`: the admin username for the admin created in initial startup
- `SFTPGO_DEFAULT_ADMIN_PASSWORD`: the admin password for the admin created in initial startup
- `SFTP_SERVER_ADDR`: The address on which the sftpgo server is reachable, this is needed for the only office document server integration thus the address needs to be exposed to it
- `ONLYOFFICE_SERVER_ADDR`: The address for document server address, this is used to import the necessary javascript module to use the document server API and needs to be reachable by the web client

## Using docker compose

To have everything up and running, you can use `docker-compose` to start the necessary comopenents:

- web proxy with sftpgo
- document server

This is done by running:

```bash
docker-compose up -d
```

This creates the admin with the credentials available in the docker compose env file. To configure it, expose the env variables as described above.

Sftpgo server should be accessible through <http://localhost:8060>
